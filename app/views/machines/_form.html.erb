<%= simple_form_for(@machine) do |f| %>
  <% if @machine.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@machine.errors.count, "error") %> prohibited this machine from being saved:</h2>

      <ul>
      <% @machine.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <table class="inputs">
    <thead>
      <tr><th colspan="2"><%= @machine.nom.present? ? @machine.nom : "Nouvelle machine" %></th></tr>
    </thead>
    <tbody>
      <%= f.input :nom %>
      <%= f.input :ancien_nom %>
      <%= f.input :ip %>
      <%= f.input :virtuelle %>
      <%= f.association :operating_system %>
      <%= f.association :theme %>
      <%= f.association :service %>
      <%= f.input :description %>
    </tbody>
  </table>

  <table class="inputs">
    <thead>
      <tr><th colspan="2">DETAILS MATERIELS</th></tr>
    </thead>
    <tbody>
      <%= f.association :site %>
      <%= f.association :physical_rack %>
      <%= f.input :type_serveur %>
      <%= f.input :numero_serie %>
      <%= f.input :modele %>
      <%= f.input :marque %>
      <%= f.input :nb_proc, :collection => [1,2,4,6,8,10,12,16,24,32] %>
      <%= f.input :ref_proc %>
      <%= f.input :frequence, :as => :string %>
      <%= f.input :nb_coeur, :collection => [1,2,4,6,8] %>
      <%= f.input :memoire %>
      <%= f.input :type_disque %>
      <%= f.input :nb_disque, :as => :string %>
      <%= f.input :taille_disque, :as => :string %>
      <%= f.input :type_disque_alt %>
      <%= f.input :nb_disque_alt, :as => :string %>
      <%= f.input :taille_disque_alt, :as => :string %>
      <%= f.association :media_drive %>
      <%= f.association :mainteneur %>
      <%= f.input :date_mes %>
      <%= f.input :fin_garantie %>
      <%= f.input :type_contrat %>
      <%= f.input :nb_rj45, :collection => 0..32 %>
      <%= f.input :nb_fc, :collection => 0..12 %>
      <%= f.input :nb_iscsi, :collection => 0..12 %>
      <tr class="wrapper machine_applications">
        <td colspan="2">
          Applications liées:<br />
          <% Application.all(:order => :nom).group_by{|a|a.nom.first.downcase}.each do |letter,applications| %>
            <% applications.each do |application| %>
              <%= check_box_tag 'machine[application_ids][]', application.id, @machine.applications.include?(application) %>
              <%= application.nom %>
            <% end %>
            <br />
          <% end %>
        </td>
      </tr>
    </tbody>
  </table>

  <p class="actions">
    <%= f.button :submit %>
    ou <%= link_to "Retourner à la liste", applications_path %> 
    <% unless @machine.new_record? %>
      | <%= link_to "Voir", @machine %>
    <% end %>
  </p>
<% end %>
